!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Topo=e():t.Topo=e()}("undefined"!=typeof self?self:this,function(){return webpackJsonpTopo([1],{175:function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.Shape=void 0;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=n(89),a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(s),u=n(504),c=function(t){return t&&t.__esModule?t:{default:t}}(u);e.Shape=function(){function t(e){r(this,t),this.dom=a.select("#"+e),this.width=this.dom.attr("width"),this.height=this.dom.attr("height"),this.nodes=[],this.edges=[],this.lines=null,this.frontArrows=null,this.backArrows=null,this.lineTextTotal=null,this.lineTextInput=null,this.lineTextOutput=null,this.nodeGroup=null,this.selectedNodes=[],this.ctrlPress=!1,this.init()}return i(t,[{key:"init",value:function(){var t=this;this.dom.node().oncontextmenu=function(){return!1},a.select("body").on("keydown",function(){(a.event.ctrlKey||17==a.event.keyCode)&&(t.ctrlPress=!0,console.log("ctrl已按下"))}).on("keyup",function(){(a.event.ctrlKey||17==a.event.keyCode)&&(t.ctrlPress=!1,console.log("ctrl已松开"))}),this.dom.on("click",function(){t.hideContextMenu(),!1===t.ctrlPress&&t.cancelNodeSelected()}),this.brush=this.dom.append("g").attr("class","brush").style("position","fixed").style("display","none"),this.shapeContainer=this.dom.append("g").attr("id","group_shape"),this.dom.call(a.zoom().scaleExtent([.2,10]).on("zoom",function(){t.shapeContainer.attr("transform",a.event.transform)})),this.brush.call(a.brush().extent([[0,0],[this.width,this.height]]).on("start",function(){console.log("start")}).on("brush",function(){console.log("brush")}).on("end",function(){console.log("end")})),this.shapeContainer.append("g").attr("id","group_line").attr("transform","scale(0.5)").attr("class","edge"),this.shapeContainer.append("g").attr("id","group_icon").attr("transform","scale(0.5)").attr("class","node")}},{key:"loadData",value:function(t){var e=this;return a.xml(t).then(function(t){var n=new c.default,r=n.dom2js(t);e.nodes=JSON.parse(r.SwscTopoByName.element.Nodes),e.edges=JSON.parse(r.SwscTopoByName.element.Edges),e.buildShape()})}},{key:"buildNodeEdgeRelation",value:function(){var t=this;this.nodes.forEach(function(t){var e=o(t.Nx),n=o(t.Ny);"number"!==e&&(t.Nx=parseInt(t.Nx)),"number"!==n&&(t.Ny=parseInt(t.Ny))}),this.edges.forEach(function(e){e.source=t.nodes.find(function(t){return t.Svid===e.Lsource}),e.target=t.nodes.find(function(t){return t.Svid===e.Ltarget})})}},{key:"buildEdges",value:function(){var t=this;a.select("#group_line").selectAll("g").remove();var e=a.select("#group_line").selectAll("g").data(this.edges).enter().append("g").attr("id",function(t){return"group_line_"+t.Lid});this.lines=e.append("path").attr("id",function(t){return t.Lid}).attr("d",function(t){return t.source.Nx<=t.target.Nx?"M"+t.source.Nx+","+t.source.Ny+"L"+t.target.Nx+","+t.target.Ny:"M"+t.target.Nx+","+t.target.Ny+"L"+t.source.Nx+","+t.source.Ny}).attr("stroke",function(t){return t.color?t.color:"#555"}),this.frontArrows=e.append("path").attr("id",function(t){return"front_"+t.Lid}).attr("d",function(e){return t.getLineArrow(e.source.Nx,e.source.Ny,e.target.Nx,e.target.Ny,4,"front")}),this.backArrows=e.append("path").attr("id",function(t){return"back_"+t.Lid}).attr("d",function(e){return t.getLineArrow(e.source.Nx,e.source.Ny,e.target.Nx,e.target.Ny,4,"back")}),this.lineTextTotal=e.append("text").attr("id",function(t){return"total_"+t.Lid}).attr("font-size","10px").attr("text-anchor","middle").attr("dx",function(t){return Math.sqrt((t.target.Nx-t.source.Nx)*(t.target.Nx-t.source.Nx)+(t.target.Ny-t.source.Ny)*(t.target.Ny-t.source.Ny))/2}).attr("dy","-5"),this.lineTextTotal.append("textPath").attr("xlink:href",function(t){return"#"+t.Lid}).text(function(t){return t.totalText?t.totalText:""}),this.lineTextInput=e.append("text").attr("id",function(t){return"input_"+t.Lid}).attr("font-size","10px").attr("text-anchor","middle").attr("dx",function(t){return t.source.Nx<=t.target.Nx?3*Math.sqrt((t.target.Nx-t.source.Nx)*(t.target.Nx-t.source.Nx)+(t.target.Ny-t.source.Ny)*(t.target.Ny-t.source.Ny))/4:Math.sqrt((t.target.Nx-t.source.Nx)*(t.target.Nx-t.source.Nx)+(t.target.Ny-t.source.Ny)*(t.target.Ny-t.source.Ny))/4}).attr("dy","-5"),this.lineTextInput.append("textPath").attr("xlink:href",function(t){return"#"+t.Lid}).text(function(t){return t.inputText?t.inputText:""}),this.lineTextOutput=e.append("text").attr("id",function(t){return"output_"+t.Lid}).attr("font-size","10px").attr("text-anchor","middle").attr("dx",function(t){return t.source.Nx<=t.target.Nx?Math.sqrt((t.target.Nx-t.source.Nx)*(t.target.Nx-t.source.Nx)+(t.target.Ny-t.source.Ny)*(t.target.Ny-t.source.Ny))/4:3*Math.sqrt((t.target.Nx-t.source.Nx)*(t.target.Nx-t.source.Nx)+(t.target.Ny-t.source.Ny)*(t.target.Ny-t.source.Ny))/4}).attr("dy","-5"),this.lineTextOutput.append("textPath").attr("xlink:href",function(t){return"#"+t.Lid}).text(function(t){return t.outputText?t.outputText:""})}},{key:"buildNodes",value:function(){var t=this;a.select("#group_icon").selectAll("g").remove();var e=a.select("#group_icon").selectAll("g").data(this.nodes).enter().append("g").attr("id",function(t){return"group_node_"+t.Svid}).on("click",function(e){t.hideContextMenu();var n="#circle_"+e.Svid;if(!0===t.ctrlPress){console.log("点击时ctrl按下:true"),t.selectedNodes.forEach(function(t){console.log(t.Svid)});var r=t.selectedNodes.indexOf(e);r>-1?(console.log("点选的内容已经存在"),console.log("点击之前的选中节点数："+t.selectedNodes.length),a.select(n).attr("stroke-width",0),t.selectedNodes.splice(r,1),console.log("点击之后的选中节点数："+t.selectedNodes.length)):(console.log("点选的内容不存在"),console.log("点击之前的选中节点数："+t.selectedNodes.length),t.selectedNodes.push(e),console.log("点击之后的选中节点数："+t.selectedNodes.length),t.selectedNodes.forEach(function(t){var e="#circle_"+t.Svid;a.select(e).attr("stroke-width",1.5)}))}else console.log("点击时ctrl按下:false"),t.selectedNodes.forEach(function(t){var e="#circle_"+t.Svid;a.select(e).attr("stroke-width",0)}),t.selectedNodes=[],a.select(n).attr("stroke-width",1.5),t.selectedNodes.push(e);return a.event.stopPropagation(),!1}).on("contextmenu",function(e){t.selectedNodes.length>0&&t.selectedNodes.indexOf(e)<0||(console.log(a.event),a.select(".contextmenu").style("display","block").style("left",a.event.pageX+"px").style("top",a.event.pageY+"px"),a.selectAll(".limenu").on("click",function(n,r,o){var i=o[r].id;if("liDelete"===i){t.hideContextMenu(),0===t.selectedNodes.length&&t.selectedNodes.push(e);var s=t.selectedNodes;t.deleteSelectedNodes(),t.buildEdges(),t.buildNodes(),t.onDeletedFunc&&t.onDeletedFunc(s)}if("liCreate"===i){if(t.selectedNodes.length<2)return t.hideContextMenu(),t.cancelNodeSelected(),void alert("至少需要选中两个元素");a.select("#liDelete").style("display","none"),a.select(".contentmenu").style("display","block"),a.select("#btn_topo_confirm").on("click",function(e){var n=document.querySelector("#txt_topo_name").value;if(""==n)return void alert("子拓扑名称不能为空");if(t.hideContextMenu(),t.onCreatingFunc){var r=[],o={x:0,y:0,count:0};t.selectedNodes.forEach(function(t){o.count++,o.x=o.x+t.Nx,o.y=o.y+t.Ny,r.push(t.Svid)}),t.onCreatingFunc(n,r,o.x,o.y)}})}}))}).on("dblclick",function(t){a.event.stopPropagation()}).call(a.drag().on("start",function(e){t.hideContextMenu()}).on("drag",function(e){t.draging(e)}).on("end",function(e){if(t.onDragEndFunc){var n=[];0===t.selectedNodes.length?n.push({Svid:e.Svid,Nx:e.Nx,Ny:e.Ny}):t.selectedNodes.forEach(function(t){n.push({Svid:t.Svid,Nx:t.Nx,Ny:t.Ny})}),t.onDragEndFunc(n)}}));e.append("circle").attr("id",function(t){return"circle_"+t.Svid}).attr("cx",function(t){return t.Nx}).attr("cy",function(t){return t.Ny}).attr("r",20).attr("fill","#ddd").attr("stroke","#F00").attr("stroke-dasharray","4,3").attr("stroke-width",0),e.append("image").attr("id",function(t){return"image_"+t.Svid}).attr("width",30).attr("height",25).attr("href",function(t){return t.url?t.url:"icons/"+t.Svgtype+".svg"}).attr("x",function(t){return t.Nx-15}).attr("y",function(t){return t.Ny-12.5}),e.append("text").attr("id",function(t){return"text_"+t.Svid}).attr("x",function(t){return t.Nx}).attr("y",function(t){return t.Ny}).attr("dy",22.5).attr("font-size","10px").attr("text-anchor","middle").style("cursor","default").text(function(t){return t.Localip})}},{key:"buildShape",value:function(){this.buildNodeEdgeRelation(),this.buildEdges(),this.buildNodes()}},{key:"draging",value:function(t){var e=this;this.selectedNodes.indexOf(t)>-1?this.selectedNodes.forEach(function(t){e.moveNode(t)}):(this.cancelNodeSelected(),this.moveNode(t))}},{key:"getLineArrow",value:function(t,e,n,r,o,i){var s=Math.atan2(r-e,n-t),a=Math.cos(s),u=Math.sin(s);if("front"===i){var c={x:t/4+3*n/4,y:e/4+3*r/4},l={x:c.x+2*a*o,y:c.y+2*u*o},d="M"+l.x+","+l.y,f={x:c.x+u*o,y:c.y-a*o},x={x:c.x-u*o,y:c.y+a*o},h={x:c.x+a*o/2,y:c.y+u*o/2};return d=d+"L"+f.x+","+f.y+"L"+h.x+","+h.y+"L"+x.x+","+x.y+"Z"}if("back"===i){var c={x:3*t/4+n/4,y:3*e/4+r/4},y={x:c.x-2*a*o,y:c.y-2*u*o},p="M"+y.x+","+y.y,g={x:c.x+u*o,y:c.y-a*o},N={x:c.x-u*o,y:c.y+a*o},v={x:c.x-a*o/2,y:c.y-u*o/2};return p=p+"L"+g.x+","+g.y+"L"+v.x+","+v.y+"L"+N.x+","+N.y+"Z"}}},{key:"changeLineColor",value:function(t,e){var n=this.edges.find(function(e){return e.Lid===t});n&&(n.color=e,this.lines.filter(function(e){return e.Lid===t}).attr("stroke",e))}},{key:"changeInputText",value:function(t,e){var n=this.edges.find(function(e){return e.Lid===t});n&&(n.inputText=e,this.lineTextInput.filter(function(e){return e.Lid===t}).selectAll("textPath").text(e))}},{key:"changeOutputText",value:function(t,e){var n=this.edges.find(function(e){return e.Lid===t});n&&(n.outputText=e,this.lineTextOutput.filter(function(e){return e.Lid===t}).selectAll("textPath").text(e))}},{key:"changeTotalText",value:function(t,e){var n=this.edges.find(function(e){return e.Lid===t});n&&(n.totalText=e,this.lineTextTotal.filter(function(e){return e.Lid===t}).selectAll("textPath").text(e))}},{key:"changeImageUrl",value:function(t,e){var n=this.nodes.find(function(e){return e.Svid===t});n&&(n.url=e,a.select("#image_"+t).attr("href",e))}},{key:"showText",value:function(t){var e=[];"input"===t.type?e.push(this.lineTextInput):"output"===t.type?e.push(this.lineTextOutput):"total"===t.type?e.push(this.lineTextTotal):(e.push(this.lineTextInput),e.push(this.lineTextOutput),e.push(this.lineTextTotal));var n=t.isShow?"block":"none";t.lineId?e.forEach(function(e){return e.filter(function(e){return e.Lid===t.lineId}).style("display",n)}):e.forEach(function(t){return t.style("display",n)})}},{key:"getValveData",value:function(t){var e=this.edges.find(function(e){return e.Lid===t});return e?{flow:e.Flow,warn:e.Warn,error:e.Error}:null}},{key:"getNodes",value:function(){return this.shapeContainer.select(".node").selectAll("g")}},{key:"getLines",value:function(){return this.shapeContainer.select(".edge").selectAll("g")}},{key:"moveNode",value:function(t){var e=this;t.Nx=t.Nx+a.event.dx,t.Ny=t.Ny+a.event.dy,a.select("#circle_"+t.Svid).attr("cx",function(t){return t.Nx}).attr("cy",function(t){return t.Ny}),a.select("#image_"+t.Svid).attr("x",function(t){return t.Nx-15}).attr("y",function(t){return t.Ny-12.5}),a.select("#text_"+t.Svid).attr("x",function(t){return t.Nx}).attr("y",function(t){return t.Ny}),this.lines.filter(function(e){return e.Lsource===t.Svid||e.Ltarget===t.Svid}).attr("d",function(t){return t.source.Nx<=t.target.Nx?"M"+t.source.Nx+","+t.source.Ny+"L"+t.target.Nx+","+t.target.Ny:"M"+t.target.Nx+","+t.target.Ny+"L"+t.source.Nx+","+t.source.Ny}),this.frontArrows.filter(function(e){return e.Lsource===t.Svid||e.Ltarget===t.Svid}).attr("d",function(t){return e.getLineArrow(t.source.Nx,t.source.Ny,t.target.Nx,t.target.Ny,4,"front")}),this.backArrows.filter(function(e){return e.Lsource===t.Svid||e.Ltarget===t.Svid}).attr("d",function(t){return e.getLineArrow(t.source.Nx,t.source.Ny,t.target.Nx,t.target.Ny,4,"back")}),this.lineTextTotal.filter(function(e){return e.Lsource===t.Svid||e.Ltarget===t.Svid}).attr("dx",function(t){return Math.sqrt((t.target.Nx-t.source.Nx)*(t.target.Nx-t.source.Nx)+(t.target.Ny-t.source.Ny)*(t.target.Ny-t.source.Ny))/2}),this.lineTextInput.filter(function(e){return e.Lsource===t.Svid||e.Ltarget===t.Svid}).attr("dx",function(t){return t.source.Nx<=t.target.Nx?3*Math.sqrt((t.target.Nx-t.source.Nx)*(t.target.Nx-t.source.Nx)+(t.target.Ny-t.source.Ny)*(t.target.Ny-t.source.Ny))/4:Math.sqrt((t.target.Nx-t.source.Nx)*(t.target.Nx-t.source.Nx)+(t.target.Ny-t.source.Ny)*(t.target.Ny-t.source.Ny))/4}),this.lineTextOutput.filter(function(e){return e.Lsource===t.Svid||e.Ltarget===t.Svid}).attr("dx",function(t){return t.source.Nx<=t.target.Nx?Math.sqrt((t.target.Nx-t.source.Nx)*(t.target.Nx-t.source.Nx)+(t.target.Ny-t.source.Ny)*(t.target.Ny-t.source.Ny))/4:3*Math.sqrt((t.target.Nx-t.source.Nx)*(t.target.Nx-t.source.Nx)+(t.target.Ny-t.source.Ny)*(t.target.Ny-t.source.Ny))/4})}},{key:"cancelNodeSelected",value:function(){this.selectedNodes.forEach(function(t){var e="#circle_"+t.Svid;a.select(e).attr("stroke-width",0)}),this.selectedNodes=[]}},{key:"hideContextMenu",value:function(){a.selectAll(".limenu").style("display","block"),a.select(".contextmenu").style("display","none")}},{key:"onDragEnd",value:function(t){this.onDragEndFunc=t}},{key:"onDeleted",value:function(t){this.onDeletedFunc=t}},{key:"onCreating",value:function(t){this.onCreatingFunc=t}},{key:"deleteSelectedNodes",value:function(){var t=this;this.selectedNodes.forEach(function(e){for(var n=t.edges.length-1;n>=0;n--){var r=t.edges[n];r.source!==e&&r.target!==e||t.edges.splice(n,1)}var n=t.nodes.indexOf(e);t.nodes.splice(n,1)}),this.cancelNodeSelected()}},{key:"appendNode",value:function(t){this.nodes.push(t)}},{key:"appendEdge",value:function(t){this.edges.push(t)}},{key:"getNodeById",value:function(t){return this.nodes.find(function(e){return e.Svid===t})}},{key:"setBrushState",value:function(t){var e=!0===t?"block":"none";this.brush.style("display",e)}}]),t}()},504:function(t,e,n){"use strict";var r,o,i,s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(n,s){o=[],r=s,void 0!==(i="function"==typeof r?r.apply(e,o):r)&&(t.exports=i)}(0,function(t){return function(e){function n(t){var e=t.localName;return null==e&&(e=t.baseName),null!=e&&""!==e||(e=t.nodeName),e}function r(t){return t.prefix}function o(t){return"string"==typeof t?t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;"):t}function i(t){return t.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#x27;/g,"'").replace(/&amp;/g,"&")}function a(t,n,r){switch(e.arrayAccessForm){case"property":t[n]instanceof Array?t[n+"_asArray"]=t[n]:t[n+"_asArray"]=[t[n]]}if(!(t[n]instanceof Array)&&e.arrayAccessFormPaths.length>0){for(var o=!1,i=0;i<e.arrayAccessFormPaths.length;i++){var s=e.arrayAccessFormPaths[i];if("string"==typeof s){if(s===r){o=!0;break}}else if(s instanceof RegExp){if(s.test(r)){o=!0;break}}else if("function"==typeof s&&s(n,r)){o=!0;break}}o&&(t[n]=[t[n]])}}function u(t){var e=t.split(/[-T:+Z]/g),n=new Date(e[0],e[1]-1,e[2]),r=e[5].split(".");if(n.setHours(e[3],e[4],r[0]),r.length>1&&n.setMilliseconds(r[1]),e[6]&&e[7]){var o=60*e[6]+Number(e[7]);o=0+("-"===(/\d\d-\d\d:\d\d$/.test(t)?"-":"+")?-1*o:o),n.setMinutes(n.getMinutes()-o-n.getTimezoneOffset())}else-1!==t.indexOf("Z",t.length-1)&&(n=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds())));return n}function c(t,n,r){if(e.datetimeAccessFormPaths.length>0)for(var o=r.split(".#")[0],i=0;i<e.datetimeAccessFormPaths.length;i++){var s=e.datetimeAccessFormPaths[i];if("string"==typeof s){if(s===o)return u(t)}else if(s instanceof RegExp){if(s.test(o))return u(t)}else if("function"==typeof s&&s(o))return u(t)}return t}function l(t){for(var r={},o=t.childNodes,i=0;i<o.length;i++){var s=o.item(i);if(s.nodeType===k.ELEMENT_NODE){var a=n(s);e.ignoreRoot?r=f(s,a):r[a]=f(s,a)}}return r}function d(t,o){var s={};s.__cnt=0;for(var u=t.childNodes,l=0;l<u.length;l++){var d=u.item(l),x=n(d);d.nodeType!==k.COMMENT_NODE&&(s.__cnt++,null==s[x]?(s[x]=f(d,o+"."+x),a(s,x,o+"."+x)):(s[x]instanceof Array||(s[x]=[s[x]],a(s,x,o+"."+x)),s[x][s[x].length]=f(d,o+"."+x)))}for(var h=0;h<t.attributes.length;h++){var y=t.attributes.item(h);s.__cnt++;for(var p=y.value,g=0;g<e.attributeConverters.length;g++){var N=e.attributeConverters[g];N.test.call(null,y.name,y.value)&&(p=N.convert.call(null,y.name,y.value))}s[e.attributePrefix+y.name]=p}var v=r(t);return v&&(s.__cnt++,s.__prefix=v),s["#text"]&&(s.__text=s["#text"],s.__text instanceof Array&&(s.__text=s.__text.join("\n")),e.escapeMode&&(s.__text=i(s.__text)),e.stripWhitespaces&&(s.__text=s.__text.trim()),delete s["#text"],"property"===e.arrayAccessForm&&delete s["#text_asArray"],s.__text=c(s.__text,"#text",o+".#text")),s.hasOwnProperty("#cdata-section")&&(s.__cdata=s["#cdata-section"],delete s["#cdata-section"],"property"===e.arrayAccessForm&&delete s["#cdata-section_asArray"]),1===s.__cnt&&s.__text?s=s.__text:0===s.__cnt&&"text"===e.emptyNodeForm?s="":s.__cnt>1&&void 0!==s.__text&&e.skipEmptyTextNodesForObj&&(e.stripWhitespaces&&""===s.__text||""===s.__text.trim())&&delete s.__text,delete s.__cnt,e.keepCData||s.hasOwnProperty("__text")||!s.hasOwnProperty("__cdata")?(e.enableToStringFunc&&(s.__text||s.__cdata)&&(s.toString=function(){return(this.__text?this.__text:"")+(this.__cdata?this.__cdata:"")}),s):s.__cdata?s.__cdata:""}function f(t,e){return t.nodeType===k.DOCUMENT_NODE?l(t):t.nodeType===k.ELEMENT_NODE?d(t,e):t.nodeType===k.TEXT_NODE||t.nodeType===k.CDATA_SECTION_NODE?t.nodeValue:null}function x(t,n,r,i){var s="<"+(t&&t.__prefix?t.__prefix+":":"")+n;if(r)for(var a=0;a<r.length;a++){var u=r[a],c=t[u];e.escapeMode&&(c=o(c)),s+=" "+u.substr(e.attributePrefix.length)+"=",e.useDoubleQuotes?s+='"'+c+'"':s+="'"+c+"'"}return s+=i?" />":">"}function h(t,e){return"</"+(t&&t.__prefix?t.__prefix+":":"")+e+">"}function y(t,e){return-1!==t.indexOf(e,t.length-e.length)}function p(t,n){return!!("property"===e.arrayAccessForm&&y(n.toString(),"_asArray")||0===n.toString().indexOf(e.attributePrefix)||0===n.toString().indexOf("__")||t[n]instanceof Function)}function g(t){var e=0;if(t instanceof Object)for(var n in t)p(t,n)||e++;return e}function N(t){var n=[];if(t instanceof Object)for(var r in t)-1===r.toString().indexOf("__")&&0===r.toString().indexOf(e.attributePrefix)&&n.push(r);return n}function v(t){var n="";return t.__cdata&&(n+="<![CDATA["+t.__cdata+"]]>"),t.__text&&(e.escapeMode?n+=o(t.__text):n+=t.__text),n}function _(t){var n="";return t instanceof Object?n+=v(t):null!==t&&(e.escapeMode?n+=o(t):n+=t),n}function m(t,e,n){var r="";if(0===t.length)r+=x(t,e,n,!0);else for(var o=0;o<t.length;o++)r+=b(t[o],e,N(t[o]));return r}function b(t,n,r){var o="";if(void 0!==t&&null!==t&&""!==t||!e.selfClosingElements)if("object"===(void 0===t?"undefined":s(t)))if("[object Array]"===Object.prototype.toString.call(t))o+=m(t,n,r);else if(t instanceof Date)o+=x(t,n,r,!1),o+=t.toISOString(),o+=h(t,n);else{var i=g(t);i>0||t.__text||t.__cdata?(o+=x(t,n,r,!1),o+=S(t),o+=h(t,n)):e.selfClosingElements?o+=x(t,n,r,!0):(o+=x(t,n,r,!1),o+=h(t,n))}else o+=x(t,n,r,!1),o+=_(t),o+=h(t,n);else o+=x(t,n,r,!0);return o}function S(t){var e="";if(g(t)>0)for(var n in t)if(!p(t,n)){var r=t[n],o=N(r);e+=b(r,n,o)}return e+=_(t)}function T(e){if(void 0===e)return null;if("string"!=typeof e)return null;var n=null,r=null;if(t)n=new t,r=n.parseFromString(e,"text/xml");else if(window&&window.DOMParser){n=new window.DOMParser;var o=null,i=window.ActiveXObject||"ActiveXObject"in window;if(!i)try{o=n.parseFromString("INVALID","text/xml").childNodes[0].namespaceURI}catch(t){o=null}try{r=n.parseFromString(e,"text/xml"),null!==o&&r.getElementsByTagNameNS(o,"parsererror").length>0&&(r=null)}catch(t){r=null}}else 0===e.indexOf("<?")&&(e=e.substr(e.indexOf("?>")+2)),r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(e);return r}e=e||{},function(){e.arrayAccessForm=e.arrayAccessForm||"none",e.emptyNodeForm=e.emptyNodeForm||"text",e.attributeConverters=e.attributeConverters||[],e.datetimeAccessFormPaths=e.datetimeAccessFormPaths||[],e.arrayAccessFormPaths=e.arrayAccessFormPaths||[],void 0===e.enableToStringFunc&&(e.enableToStringFunc=!0),void 0===e.skipEmptyTextNodesForObj&&(e.skipEmptyTextNodesForObj=!0),void 0===e.stripWhitespaces&&(e.stripWhitespaces=!0),void 0===e.useDoubleQuotes&&(e.useDoubleQuotes=!0),void 0===e.ignoreRoot&&(e.ignoreRoot=!1),void 0===e.escapeMode&&(e.escapeMode=!0),void 0===e.attributePrefix&&(e.attributePrefix="_"),void 0===e.selfClosingElements&&(e.selfClosingElements=!0),void 0===e.keepCData&&(e.keepCData=!1)}(),function(){function t(t){var e=String(t);return 1===e.length&&(e="0"+e),e}"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|^\n+|(\s|\n)+$/g,"")}),"function"!=typeof Date.prototype.toISOString&&(Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+t(this.getUTCMonth()+1)+"-"+t(this.getUTCDate())+"T"+t(this.getUTCHours())+":"+t(this.getUTCMinutes())+":"+t(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"})}();var k={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,COMMENT_NODE:8,DOCUMENT_NODE:9};this.asArray=function(t){return void 0===t||null===t?[]:t instanceof Array?t:[t]},this.toXmlDateTime=function(t){return t instanceof Date?t.toISOString():"number"==typeof t?new Date(t).toISOString():null},this.asDateTime=function(t){return"string"==typeof t?u(t):t},this.xml2dom=function(t){return T(t)},this.dom2js=function(t){return f(t,null)},this.js2dom=function(t){return T(this.js2xml(t))},this.xml2js=function(t){var e=T(t);return null!=e?this.dom2js(e):null},this.js2xml=function(t){return S(t)},this.getVersion=function(){return"3.1.1"}}})}},[175])});